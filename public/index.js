function h(c){return(...b)=>{var a={};b=c.call(a,...b);b=(new DOMParser).parseFromString(b,"text/html");console.log("ctx: ",a);b=b.getElementsByTagName("body").item(0).firstChild;a=a.init.call(a,b);a.node=b;return a}}
function k(c,b){void 0===b&&(b={});b=b.insertAt;if(c&&"undefined"!==typeof document){var a=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css";"top"===b?a.firstChild?a.insertBefore(d,a.firstChild):a.appendChild(d):a.appendChild(d);d.styleSheet?d.styleSheet.cssText=c:d.appendChild(document.createTextNode(c))}}k("#nav{background:rgba(0,0,0,.5019607843137255);height:63px;display:flex}.navc{justify-content:space-evenly;align-self:center}.navc .sel{color:#db8b1d}");
let l=h(function(){let c=0,b=[];this.init=function(a){console.log("elem: ",a);const d=a.querySelectorAll("li");console.log("buttons: ",d);d.forEach((a,e)=>{a.addEventListener("click",()=>{c=e;d.forEach((a,b)=>{b===c?a.classList.add("sel"):a.classList.remove("sel")});b.map(a=>a.call(void 0,e))})});return{onClick:a=>{b.push(a)},currentIndex:()=>c,destroy:()=>{b=[]}}};return'<ul class="fw navc"><li class="sel">Home</li><li>Routines</li><li>Settings</li></ul>'});k("#card{height:100%;position:fixed;width:100%;top:100%;background:rgba(83,83,83,.47058823529411764)}#card.an{transition:top .2s ease-in-out}");
k(".sc{padding:20px}.slider{background:linear-gradient(90deg,#db8b1d 0,#db8b1d 50%,#606060 0,#606060);border-radius:8px;height:7px;width:75%;border-radius:15px;height:6px;-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;outline:none}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;background:#fff;box-shadow:#000;border-radius:50%;cursor:pointer}");
let m=document.getElementById.bind(document),q=c=>c.stopPropagation(),r=h(function({label:c,value:b,id:a}){this.init=function(d){d.id=a;d.querySelector("h4").innerText=c;const f=d.querySelector("input");f.onmousedown=q;f.ontouchstart=q;f.oninput=function(){const a=(parseInt(f.value)-parseInt(f.min))/(parseInt(f.max)-parseInt(f.min))*100;f.style.background="linear-gradient(to right, #DB8B1D 0%, #DB8B1D "+a+"%, #606060 "+a+"%, #606060 100%)"};console.log("slider: ",f,b);f.value=b;return{destroy:()=>
{}}};return'<div class="sc"><div class="fR fSB"><h4>Title</h4><h4>Value</h4></div><input class="slider" type="range" min="0" max="100"></div>'}),t=h(function(){let c=!1,b=0,a=0,d=!1,f={};this.init=function(e){function g(a=!1){a!==d&&(a?e.classList.add("an"):e.classList.remove("an"),d=a)}function n(a){console.log("on transition end: ",a);e.remove()}function p(a){console.log("move event: ",a);let {x:b,y:c}=a;null==b&&(b=a.touches[0].clientX,c=a.touches[0].clientY);return{x:b,y:c}}g(!0);const y=r({id:"position",
label:"Position",value:"50"});e.appendChild(y.node);e.onmousedown=e.ontouchstart=b=>{f=b=p(b);a=b.y;c=!0;g(!1)};e.onmouseup=e.onmouseout=e.ontouchend=()=>{if(c){c=!1;g(!0);var d=0;b>e.clientHeight/2&&(d=e.clientHeight,e.ontransitionend=n);e.style.top=`${d}px`;b=a=0}};e.onmousemove=e.ontouchmove=d=>{d=p(d);c&&(0>d.y-a?f=d:(b+=d.y-f.y,f=d,e.style.top=`${b}px`))};return{destroy:n,show:()=>{e.style.top="0px"}}};return'<div id="card" class="an"></div>'});k(".dt{justify-content:space-between}.tile{background:rgba(0,0,0,.30196078431372547);border-radius:12px;display:flex}.tile.sq{width:110px;height:110px;margin:5px 0;position:relative}.tile.sq>span{width:109px;max-height:90px;top:10px;position:absolute;right:0;border-right:1px groove #fff}.pt>.sq{height:50px;width:auto;min-width:150px}.pt>.sq>span{display:none}.tile.sq p{font-size:11px;margin:auto 21px 10px 9px;font-weight:500}");
let u=h(function({name:c,id:b}){let a=[];this.init=function(d){d.id=b;d.onclick=()=>{a.forEach(a=>a({id:b,name:c}))};d.querySelector("p").innerText=c;return{onClick:b=>{a.push(b)},destroy:()=>{a=[]}}};return'<div class="tile sq"><span></span><p>Bedroom Left</p></div>'});
class v{constructor(){this._observers={};this._state={}}update(c,b){var a,d;null!==(a=(d=this._observers)[c])&&void 0!==a?a:d[c]=[];let f=this._state[c];this._state[c]=b;this._observers[c].forEach(a=>{a({value:{...b},prev:f})})}observe(c,b){var a,d;null!==(a=(d=this._observers)[c])&&void 0!==a?a:d[c]=[];this._observers[c].push(b);this._state[c]&&b({value:{...this._state[c]},prev:void 0})}}
let w=new v,x=h(function(){let c=!0,b=[],a=[];this.init=function(){function d(){c&&(m("hl").style.display="none",m("hlc").classList.remove("hide"),c=!1)}function f(a){a=m(`${a}-tiles`);return{container:a,tiles:a.querySelectorAll("div")}}function e(a){const {container:b,tiles:c}=f(a);a=Math.floor(b.clientWidth/110);let d=c.length;for(;0!==d%a;){const a=document.createElement("div");a.classList.add("tile","sq","em");b.appendChild(a);d++}}function g(a,c){const {container:d,tiles:p}=f(a);p.forEach(a=>
{a.id in c&&(c[a.id]=void 0)});for(const [e,f]of Object.entries(c)){if(!f)continue;const c=u({id:`tile-${e}`,name:f.name||e,...f});c.onClick(b=>n(a,b));b.push(c);d.appendChild(c.node)}e(a)}function n(b,c){"device"===b&&a.forEach(a=>a(c))}w.observe("presets",({value:a,prev:b})=>{console.log("presets updated: ",a,b);d();g("preset",a)});w.observe("devices",({value:a,prev:b})=>{console.log("devices updated: ",a,b);d();g("device",a)});return{onDeviceClick:b=>{a.push(b)},destroy:()=>{a=[];b.forEach(a=>
a.destroy());b=[]}}};return'<div class="f flex" id="h"><div class="loader" id="hl"></div><div id="hlc" class="hide" style="text-align: left;"><h1 id="ht">WBlinds</h1><h4 class="hst">Presets</h4><div id="preset-tiles" class="pt fw flex wrap"></div><h4 class="hst">Devices</h4><div id="device-tiles" class="dt fw flex wrap"></div></div></div>'}),z={init:()=>{},restore:()=>{}};console.log("use mocks: ","true","string");
{let c=window.fetch,b={"Going to bed":{state:{"mac-address":{position:50,speed:50,accel:50},"mac-address-2":{position:50,speed:50,accel:50}},routines:[]}},a={"mac-address":{name:"Bedroom Left",position:50,speed:50,accel:50},"mac-address-2":{name:"Bedroom Right",position:50,speed:50,accel:50},"mac-address-3":{name:"Bay Window Left",position:50,speed:50,accel:50},"mac-address-4":{name:"Bay Window Middle",position:50,speed:50,accel:50},"mac-address-5":{name:"Bay Window Right",position:50,speed:50,accel:50}};
z={init:()=>{window.fetch=async c=>({json:()=>"/devices"===c?a:b,ok:!0})},restore:()=>{window.fetch=c}}}let A=z;var B,C=B||(B={});C.GET="GET";C.POST="POST";function D(c,b){console.log("this: ",this);return fetch(c,{method:b}).then(a=>{if(!a.ok)throw a;return a.json()})}
function E(){function c(a){var c;console.log("on click! ",a);if(f!==a){f=a;null===(c=null===e||void 0===e?void 0:e.destroy)||void 0===c?void 0:c.call(e);console.log("currentTab.node: ",null===e||void 0===e?void 0:e.node);null===e||void 0===e?void 0:e.node.remove();switch(a){case 0:a=x();a.onDeviceClick(b);e=a;console.log("node: ",e.node);break;case 1:e=null;break;case 2:e=null}e&&d.appendChild(e.node)}}function b(b){console.log("device clicked: ",b);b=t({});a.appendChild(b.node);setTimeout(b.show)}
A.init();let a=document.querySelector("body"),d=m("app");window.wblinds.State=w;D("/presets").then(a=>{console.log("presets res: ",a);w.update("presets",a)});D("/devices").then(a=>{console.log("devices res: ",a);w.update("devices",a)});let f=-1,e;c(0);let g=l();console.log("node: ",g.node);m("nav").appendChild(g.node);console.log("nav: ",g.currentIndex());g.onClick(c)}k(':root{--blue:#06c;--green:#32d74b;--input:#db8b1d}html{touch-action:manipulation}body{margin:0;background-color:#111;font-family:-apple-system,BlinkMacSystemFont,helvetica,sans-serif;font-size:17px;font-weight:400;color:#fff;text-align:center;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;scrollbar-width:6px;scrollbar-color:var(--c-sb) transparent}body,html{height:100%;width:100%;position:fixed;-ms-scroll-chaining:none;overscroll-behavior:none}h1,h4{font-weight:400}h1{font-size:32px}h4{-webkit-margin-after:.3em;margin-block-end:.3em;font-size:14px;padding-left:5px}.hide{display:none}.loader,.loader:after,.loader:before{border-radius:50%;width:2.5em;height:2.5em;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation:load7 1.8s ease-in-out infinite;animation:load7 1.8s ease-in-out infinite}.loader{margin:auto;color:#fff;font-size:10px;text-indent:-9999em;transform:translate3d(0,-100px,0);-webkit-animation-delay:-.16s;animation-delay:-.16s;align-self:center}.loader:after,.loader:before{content:"";position:absolute;top:0}.loader:before{left:-3.5em;-webkit-animation-delay:-.32s;animation-delay:-.32s}.loader:after{left:3.5em}@-webkit-keyframes load7{0%,80%,to{box-shadow:0 2.5em 0 -1.3em}40%{box-shadow:0 2.5em 0 0}}@keyframes load7{0%,80%,to{box-shadow:0 2.5em 0 -1.3em}40%{box-shadow:0 2.5em 0 0}}.em{opacity:0}ul{display:flex;list-style-type:none;-webkit-margin-before:0;margin-block-start:0;-webkit-margin-after:0;margin-block-end:0;-webkit-padding-start:0;padding-inline-start:0}li{display:list-item;text-align:-webkit-match-parent;color:hsla(0,0%,100%,.4)}li.s{color:#db8b1d}.f{width:100%;height:100%}.fC,.flex{display:flex}.fC{flex-direction:column}.fR{display:flex;flex-direction:row}.fSB{justify-content:space-between}.wrap{flex-wrap:wrap}.fh{height:100%}.fw{width:100%}#bg{height:100vh;width:100vw;position:fixed;z-index:-10;background-position:30%;background-repeat:no-repeat;background-size:cover;opacity:1;transition:opacity 2s;background-image:url(https://github.com/maxakuru/WBlinds/blob/main/public/bg.jpg?raw=true),linear-gradient(0deg,#30cfd0 0,#330867)}#app{display:flex;flex-direction:column;padding:23px 23px 0;height:calc(100% - 86px);overflow-y:scroll}.overlay{position:fixed;height:100%;width:100%;top:0;left:0;background-color:#333;font-size:24px;display:flex;align-items:center;justify-content:center;z-index:11;opacity:.95;transition:.7s;pointer-events:none}');
window.wblinds={test:!0};window.onload=()=>E()

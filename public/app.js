function t(a){return(...b)=>{var d={};b=a.call(d,...b);b=(new DOMParser).parseFromString(b,"text/html").getElementsByTagName("body").item(0).firstChild;d=d.init(b);d.node=b;return d}}stynj("#nav{background:rgba(0,0,0,.5);height:50px;display:flex;font-size:14px;justify-content:center}.navc{justify-content:space-around;align-self:center;max-width:500px}.navc .sel{color:#db8b1d}#nav>ul>li>.l{-webkit-margin-before:0;margin-block-start:0;-webkit-margin-after:0;margin-block-end:0;font-size:8px}");
const y=DOMTokenList.prototype;function A(a,...b){y.add.call(a.classList,...b)}function F(a,...b){y.remove.call(a.classList,...b)}
const G=setTimeout,J=document,K=window,L=J.createElement.bind(J),M=J.createElement.bind(J,"div"),O=J.getElementById.bind(J),aa=(a,b=J)=>b.getElementsByTagName.call(b,a),P=(a,b=J)=>b.querySelector.call(b,a),ba=a=>a.stopPropagation(),S=J.appendChild,T=a=>a&&"object"===typeof a&&!Array.isArray(a),U=(a,...b)=>{if(!b.length)return a;const d=b.shift();if(T(a)&&T(d))for(const f in d)T(d[f])?(a[f]||Object.assign(a,{[f]:{}}),U(a[f],d[f])):Object.assign(a,{[f]:d[f]});return U(a,...b)},V=(...a)=>{console.debug.call(console,
...a)},ca=a=>{const b={};for(const d in a)null!=a[d]&&(b[d]=a[d]);return b},X=[],da=a=>{const b=X.push(a);return()=>{delete X[b-1]}},ea=()=>{X.forEach(a=>{a&&a()})},fa=(a,b,d)=>{b=b||{};null==d&&(d=!0);const f=location.pathname,h=location.search;d=new URLSearchParams(d?"":h);for(const l in b)d.set(l,b[l]);b=d.toString();0<b.length&&(b="?"+b);a===f&&b===h?V("no change: ",a,f,b,h):(a=(a||f)+b,V("push history: ",a),history.pushState(null,"",a),b!==h&&ea())};
t(function({labels:a}){let b=0,d=[];const f=[];this.init=h=>{const l=w=>{b=w;f.forEach((u,q)=>{q===b?A(u,"sel"):F(u,"sel")});d.map(u=>u(w))};a.map((w,u)=>{const q=L("li");A(q,"fC");u===b&&A(q,"sel");var c=L("i");S.call(c,w.i);S.call(q,c);c=L("p");A(c,"l");c.innerText=w.t;S.call(q,c);f.push(q);S.call(h,q);q.onclick=()=>l(u)});return{onClick:w=>{d.push(w)},currentIndex:()=>b,destroy:()=>{d=[]},setIndex:l}};return'<ul class="fw navc"></ul>'});stynj(":root{--oc:#1d95db;--cc:#606060}.sc{pointer-events:none;padding:20px;align-self:center;align-items:center;justify-content:center;height:59%;overflow-x:hidden;width:50vh}.slider{pointer-events:all;transform:rotate(90deg);background:linear-gradient(90deg,var(--cc) 0,var(--cc) 50%,var(--oc) 0,var(--oc));height:7px;outline:none;border-radius:15px;height:150px;-webkit-appearance:none;-moz-appearance:none;appearance:none;width:400px}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:30px;transform:translateX(-15px);height:70px;background:transparent;border-right:2px solid #fff;box-shadow:#000;cursor:pointer}");
const Y=(a,b,d,f,h,l)=>{b=(b-d)/(f-d)*100;a.style.background=`linear-gradient(to right, ${h} 0%, ${h} ${b}%, ${l} ${b}%, ${l} 100%`},ha=t(function({value:a}){let b=[];this.init=d=>{const f=P("input",d);f.onmousedown=f.ontouchstart=ba;const h=parseInt,l=h(f.min),w=h(f.max);f.oninput=()=>{const u=h(f.value);Y(f,u,l,w,"#606060","#1d95db")};f.onchange=()=>{const u=h(f.value);b.forEach(q=>q(u))};f.value=`${a}`;Y(f,a,l,w,"#606060","#1d95db");return{destroy:()=>{b=[]},onChange:u=>{b.push(u)}}};return'<div class="sc flex"><input class="slider" type="range" min="0" max="100"></div>'});
stynj('#card{position:fixed;top:100%;background:rgb(9 9 9/88%);border-radius:30px 30px 0 0;text-align:left;justify-content:center;font-size:12px}#card:after{content:"-";transform:scaleX(20) translate(.5px);position:fixed;color:var(--cc)}#card.an,#card>.an{transition:top .2s ease-in-out}.ca-con{width:80%;max-width:300px;padding-top:50px}.cR{margin-bottom:50px}#card .act{position:fixed;right:23px;top:100%;font-size:20px;font-weight:100;transform:scaleX(1.3)}');stynj(':root{--c:#1d95db}.in{justify-content:space-between;height:50px;align-items:center;background:rgba(0,0,0,.56);padding:0 0 0 15px;border-radius:15px;min-width:300px;font-size:14px}.in.disabled{color:grey}.in>label{font-weight:700}.igroup>.in{margin-top:0;border-radius:0;border-bottom:1px solid hsla(0,0%,100%,.30196078431372547)}.igroup>.in:first-child{border-radius:15px 15px 0 0;margin-top:20px}.igroup>.in:last-child{border-radius:0 0 15px 15px;margin-bottom:20px;border-bottom:none}.in-r{background:linear-gradient(90deg,var(--c) 0,var(--c) 50%,#606060 0,#606060);border-radius:8px;height:7px;width:75%;border-radius:15px;height:6px;-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;outline:none}.in-r::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;background:#fff;box-shadow:#000;border-radius:50%;cursor:pointer}.in>input:not([type=checkbox]),.in>select{flex-grow:1;padding:10px 27px 10px 0;background:transparent;border:none;color:#db8b1d;-moz-text-align-last:right;text-align-last:right;-webkit-appearance:none;-moz-appearance:none;text-align:right}.in>select+span{left:-10px;transform:scale(1.6,.9) translateY(-1px);font-weight:200;color:#db8b1d}.in>span{color:#5f5f5f;position:relative;font-size:12px;pointer-events:none;margin-left:-20px;left:-5px}.in>select{margin-inline:12px}.in:focus-within{box-shadow:inset -1px 0 rgba(219,139,29,.627)}.in>input:is([type=checkbox]){margin-right:15px}.in>input:disabled{color:grey}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}[type=checkbox]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:51px;height:31px;border-radius:50px;background-color:rgba(148,148,154,.2)!important}[type=checkbox]:after{content:"";width:50%;border-radius:100%;height:80%;display:block;position:relative;background-color:#fff;top:12%;left:3%;transition:all .2s ease-in-out}[type=checkbox].on{background-color:#34c759!important}[type=checkbox].on:after{left:45%}');
const ja={[1]:"text",[2]:"checkbox",[0]:"number",[3]:"select",[4]:"password",[5]:"range"},ka=t(function({label:a,type:b,enumOpts:d,placeholder:f,value:h,unit:l,embed:w=!0,prevDefault:u=!1,min:q,max:c}){let g=h,e,n=[];const x=m=>{function r(v){""===v&&(v=void 0);g=v;n.forEach(D=>D(g))}m.innerHTML="";w&&A(m,"in");var z=L("label");z.innerText=a;S.call(m,z);3===b?(e=L("select"),A(m,"in-s"),d.forEach(v=>{const D=L("option");D.value=v.v;D.innerText=v.l;S.call(e,D)}),e.onchange=v=>{u&&v.preventDefault();
r(d[e.options.selectedIndex].v)}):(e=L("input"),e.type=ja[b],e.placeholder=f||"xxxxx",null!=q&&(e.min=`${q}`),null!=c&&(e.max=`${c}`),5===b&&A(e,"in-r"),2===b?((e.checked=h)&&A(e,"on"),e.onchange=v=>{u&&v.preventDefault();y.toggle.call(e.classList,"on");r(e.checked)}):e.onchange=v=>{u&&v.preventDefault();r(e.value)});null!=h&&(e.value=h);e.id=z.htmlFor=`in-${a.split(" ").join("-")}`;S.call(m,e);if(3===b||l)z=L("span"),z.innerText=l?l:"v",S.call(m,z)};this.init=m=>{x(m);return{onChange:r=>{n.push(r)},
setDisabled:r=>{y.toggle.call(m.classList,"disabled");e.disabled=r},destroy:()=>{n=[]},reset:()=>{x(m)},isDirty:()=>h!==g}};return'<div class="fR"></div>'}),la=["Speed","Acceleration"],ma=[[1,5E3],[1,4294967294]];
t(function({pos:a,accel:b,speed:d,...f}){let h=[],l=!1,w=0,u=0,q=!1,c={},g=[];this.init=e=>{function n(k){null==k&&(k=!1);k!==q&&(k?A(e,"an"):F(e,"an"),k?A(m,"an"):F(m,"an"),q=k)}const x=P(".ca-con",e),m=P(".act",e);n(!0);V("card data: ",f);const r=k=>{h.forEach(B=>B(k))},z=k=>{const B=0===k?d:b,H=ka({type:5,label:la[k],value:B,embed:!1,min:ma[k][0],max:ma[k][1]}),E=P("input",H.node);F(H.node,"fR");A(H.node,"cR");const I=parseInt,N=I(E.min),W=I(E.max);E.oninput=()=>{const Q=I(E.value);Y(E,Q,N,W,"#1d95db",
"#606060")};H.onChange(Q=>{0===k?r({speed:Q,...f}):1===k&&r({accel:Q,...f})});S.call(x,H.node);Y(E,B,N,W,"#1d95db","#606060");g.push(H)};z(0);z(1);const v=ha({value:a});v.onChange(k=>{r({tPos:k,...f})});S.call(x,v.node);const D=()=>{n(!0);e.ontransitionend=C;const k=e.clientHeight;e.style.top=`${k}px`;m.style.top=`${k+12}px`};m.onclick=D;const C=()=>{h=[];v.destroy();g.forEach(k=>k.destroy());g=[];e.remove()},p=k=>{let {x:B,y:H}=k;null==B&&(B=k.touches[0].clientX,H=k.touches[0].clientY);return{x:B,
y:H}};e.onmousedown=e.ontouchstart=k=>{c=k=p(k);u=k.y;l=!0;n(!1)};e.onmouseup=e.onmouseout=e.ontouchend=()=>{if(l){l=!1;n(!0);if(w>e.clientHeight/2)return D();e.style.top="8px";m.style.top="20px";w=u=8}};e.onmousemove=e.ontouchmove=k=>{k=p(k);l&&(8>k.y-u?c=k:(w+=k.y-c.y,c=k,e.style.top=`${w}px`,m.style.top=`${w+12}px`))};return{destroy:C,onChange:k=>{h.push(k)},show:()=>{e.style.top="8px";m.style.top="20px"}}};return'<div id="card" class="an f flex"><div class="ca-con flex fC"></div><div class="act">X</div></div>'});
stynj(":root{--wid:min(calc(33.3vw - 20px),110px,110px)}.tile{background:rgba(0,0,0,.3);border-radius:12px;display:flex}.tile.sq{width:var(--wid);height:var(--wid);margin:5px 0;position:relative}.tile.sq>span{width:calc(var(--wid) - 1px);max-height:90px;top:10px;position:absolute;right:0;border-right:1px groove #fff}.tile.sq p{font-size:11px;margin:auto 21px 10px 9px;font-weight:500}");
const na=t(function({name:a,id:b,...d}){let f=[];this.init=h=>{h.id=b;h.onclick=()=>{f.forEach(l=>l({id:b,name:a,...d}))};P("p",h).innerText=a;return{onClick:l=>{f.push(l)},destroy:()=>{f=[]}}};return'<div class="tile sq"><span></span><p>Bedroom Left</p></div>'});stynj(':root{--bord:1px solid rgba(0,0,0,0.034)}#pas{border-radius:7px;justify-content:center;max-width:400px;border:transparent;background:rgba(118,118,128,.24);margin:auto}#pas>div{padding:2px 0;flex-grow:1;text-align:center;font-size:14px;border:1px transparent}#pas>div.sel{background-color:rgba(103,103,105,.64);border-radius:7px;border:1px solid rgba(0,0,0,.14)}#pas>div:after{height:13px;content:"";display:block;position:absolute;border-left:1px solid rgba(142,142,147,.45);border-radius:.5px;transform:translate(-1px,-110%)}#pas>div:first-child:after{border-left:none}');
const oa=t(function({items:a,queries:b}){let d=0,f=[],h=[];this.init=l=>{const w=()=>{if(!(1>b.length)){a:{var c=location.search;c=c.substring(1).split("&");for(let g=0;g<c.length;g++){const e=c[g].split("=");if("tab"==e[0]){c=e[1];break a}}c=!1}c=c&&c.toLowerCase();c=b.indexOf(c);V("handleQueryChange: ",c);0>c&&(c=0);d!==c&&q(c)}},u=da(w),q=c=>{F(h[d],"sel");d=c;A(h[d],"sel");f.map(g=>g(c))};a.map((c,g)=>{const e=M();e.innerText=c;g===d&&A(e,"sel");e.onclick=()=>{b[g]&&fa(void 0,{tab:b[g]});q(g)};
h.push(e);S.call(l,e)});w();return{destroy:()=>{u();f=[];d=0;h=[]},index:()=>d,onChange:c=>{f.push(c)},setIndex:c=>{b[c]&&fa(void 0,{tab:b[c]});q(c)}}};return'<div id="pas" class="fw flex fR"></div>'});stynj(".toast{background-color:rgba(0,0,0,.44);box-shadow:1px 1px 8px rgba(84,84,84,.451);border-radius:10px;font-size:13px;margin:10px;height:60px;display:flex;min-width:250px;max-width:500px;position:relative;transition:bottom .5s ease-in-out;pointer-events:all;align-self:center}.tom{margin:auto}");
const pa=t(function({message:a,id:b}){let d=[];this.init=f=>{f.onclick=()=>{d.forEach(h=>h({id:b}))};P("p",f).innerText=a;return{onClick:h=>{d.push(h)},destroy:()=>{d=[]}}};return'<div class="toast"><p class="tom"></p></div>'});stynj(".tc{display:flex;position:absolute;top:0;flex-flow:column-reverse;pointer-events:none;height:calc(100% - 50px);padding-bottom:50px}");
t(function(){let a=0,b=[];this.init=d=>({destroy:()=>{b.map(f=>f.destroy());b=[];a=0},pushToast:(f,h,l,w)=>{h&&console.error(f);const u=()=>{c.node.style.bottom=`-${50+200*(b.length+1)}px`},q=()=>{u();setTimeout(()=>{c.node.remove()},500)},c=pa({message:f,isError:h,id:a++});u();c.onClick(q);b.push(c);S.call(d,c.node);setTimeout(()=>{c.node.style.bottom="0px";!l&&setTimeout(q,w||h?5E3:2500)})}});return'<div id="toc" class="fw tc"></div>'});
const qa={gen:{deviceName:"WBlinds",mdnsName:"WBlinds",emitSync:!1},hw:{pStep:19,pDir:18,pEn:13,pSleep:21,pReset:3,pMs1:1,pMs2:5,pMs3:17,pHome:4,cLen:1650,cDia:.1,axDia:15,stepsPerRev:200,res:16},mqtt:{enabled:!1,host:"192.168.0.99",port:1833,topic:"wblinds",user:"user"}},ra={state:{pos:0,tPos:0,accel:0,speed:0},settings:U({},qa),pendingState:U({},qa),devices:{},presets:{}};
class sa{constructor(){this._observers={};this._state=U({},ra);const a={};Object.keys(this._state).map(b=>{a[b]=!1});this._loadedKeys={...a};this._savingKeys={...a}}get(a){a=a.split(".");let b=this._state;for(;0<a.length;){if("object"!==typeof b)return;b=b[a.shift()]}return b}set(a,b){a=a.split(".");const d=a.pop();let f=this._state;for(;0<a.length;){if("object"!==typeof f)return;f=f[a.shift()]}f[d]=b}isLoaded(a){return this._loadedKeys[a]}setSaving(a,b){this._savingKeys[a]=b}isSaving(a){return this._savingKeys[a]}update(a,
b){this._observers[a]=this._observers[a]||[];const d=this._state[a];this._state[a]=U({},d,ca(b));this._loadedKeys[a]=!0;this._observers[a].forEach(f=>{f({value:{...b},prev:d})})}observe(a,b){this._observers[a]=this._observers[a]||[];this._observers[a].push(b);this._loadedKeys[a]&&b({value:U({},this._state[a]),prev:void 0})}}const Z=new sa;stynj(".dt{justify-content:space-between}.pt>.sq{height:50px;width:auto;min-width:150px}.pt>.sq>span{display:none}");
t(function(){let a=!0,b=[],d=[],f;this.init=()=>{const h=()=>{if(a){var c=O("hl"),g=O("hlc");c.style.display="none";F(g,"hide");a=!1}},l=c=>{c=O(`${c}-tiles`);return{container:c,tiles:c.querySelectorAll("div")}},w=c=>{const {container:g,tiles:e}=l(c);c=Math.floor(g.clientWidth/110);let n=e.length;for(;0!==n%c;){const x=M();A(x,"tile","sq","em");S.call(g,x);n++}},u=(c,g)=>{"device"===c&&d.forEach(e=>e(g))},q=(c,g)=>{const {container:e,tiles:n}=l(c);n.forEach(x=>{const {id:m}=x;m.endsWith(f)||m in g?
g[m]=void 0:x.remove()});for(const [x,m]of Object.entries(g)){if(!m)continue;const r=na({id:`tile-${x}`,name:m.name||x,...m});r.onClick(z=>u(c,z));b.push(r);S.call(e,r.node)}w(c)};G(()=>{Z.observe("presets",({value:c,prev:g})=>{V("presets updated: ",c,g);h();q("preset",c)});Z.observe("state",({value:c,prev:g})=>{V("state updated: ",c,g);f=Z.get("settings.gen.deviceName");h();g=Z.get("settings.gen");const e=Z.get("state");V("set tile: ",g.deviceName,{...g,...c,...e});q("device",{[g.deviceName]:{...g,
...c,...e}})});Z.observe("devices",({value:c,prev:g})=>{V("devices updated: ",c,g);h();q("device",c)})});return{onDeviceClick:c=>{d.push(c)},destroy:()=>{d=[];b.forEach(c=>c.destroy());b=[]}}};return'<div id="h" class="f flex"><div id="hl" class="loader"></div><div id="hlc" class="hide fw" style="text-align: left;"><h1 id="ht">WBlinds</h1>\x3c!-- <h4 class="hst">Presets</h4> --\x3e<div id="preset-tiles" class="pt fw flex wrap"></div><h4 class="hst">Devices</h4><div id="device-tiles" class="dt fw flex wrap"></div></div></div>'});
stynj("#stcc{display:flex}#stcc>span{margin:auto}#stcc>span:last-child{margin-bottom:70px}#stcc>div{justify-content:center}#slc-act{position:fixed;bottom:55px;justify-content:space-evenly;left:0}");stynj(".calib-btn{margin-top:40px}#calib-c,#calib-x{position:fixed;left:100%;transition:left .4s ease-in-out;top:0}#calib-c{background:url(https://github.com/maxakuru/WBlinds/blob/main/public/bg.jpg?raw=true),#000;background-position:50%;background-size:cover;overflow:hidden}#calib-c>div{width:100vw;height:100vh}#calib-c>div>h2{margin:80px 30px 10px}#calib-c>div>p{font-size:13px;margin:5px 30px 10px}#calib-x{margin:10px;width:90px;transition-delay:0s;transition-duration:.4s}.cal-conc{margin:20px auto;max-width:300px;display:flex;flex-wrap:wrap}");
const ta=[{t:"Find home position",d:"Move to the fully open position then tap 'Done'. \nBe careful not to wind the cord too tight."},{t:"Find closed position",d:"Move to the fully closed position then tap 'Done'"},{o:!0,t:"Repeat",d:"Alternate between open and closed, tap the corresponding button in between. Repeat as many times as you like. \n\nDue to the differences in how the cord may wrap around the axis, this may or may not be needed."}],ua=t(function(){let a,b,d=!1,f=[],h,l=0;const w=window.wblinds.tc,
u=(g,e,n)=>{var x=L("div");A(x,"fC");var m=L("h2");m.innerText=`${e+1}. ${g.t}`;S.call(x,m);m=L("p");m.innerText=`${g.d}`;S.call(x,m);var r=L("div");r.style.height="90%";A(r,"fC");S.call(x,r);m=L("div");A(m,"fR");S.call(x,m);const z={div:x,c:r};x=C=>async()=>{const p=C?"preNext":"preBack";try{z[p]&&await z[p]()}catch(k){w.pushToast(`"[Calib] Error in pre: ${k}"`)}l+=C?1:-1;h.style.left=`-${K.innerWidth*l}px`};0<e&&(r=L("button"),r.innerText="Back",S.call(m,r),r.onclick=x(!1));const v=L("button"),
D=e===n-1?"Done":"Next";g.o||(v.disabled=!0);z.showNext=C=>{C?(v.innerText="",C=L("div"),A(C,"loader"),S.call(v,C)):(v.innerText=D,v.disabled=!1)};v.innerText=D;v.onclick=x(!0);S.call(m,v);return z},q=()=>{const g=L("div");A(g,"cal-conc");["speed \u25b2","move \u25b2","speed \u25bc","move \u25bc"].forEach(e=>{const n=L("button");n.innerText=e;-1<e.indexOf("up")?A(n,"btn-up"):A(n,"btn-down");S.call(g,n)});return g},c=()=>{ta.forEach((g,e)=>{const n=u(g,e,ta.length);g=q();S.call(n.c,g);g=L("button");
g.innerText="Done";S.call(n.c,g);g.onclick=async()=>{n.showNext(!0);setTimeout(()=>{n.showNext()},4E3)};S.call(h,n.div)});h.style.width=`${K.innerWidth*ta.length}px`;h.style.left="0";a.style.left="0"};this.init=g=>{h=P("div",g);const e=aa("button",g);b=e.item(0);a=e.item(1);b.onclick=()=>{d||(d=!0,F(a,"hide"),F(h,"hide"),G(c))};a.onclick=()=>{const n=.2*(l+1);h.style.transitionDuration=`${n}s`;a.style.transitionDelay=`${.2*(l-.5)}s`;a.style.transitionDuration="0.2s";h.style.left=`${K.innerWidth}px`;
a.style.left=`${K.innerWidth}px`;setTimeout(()=>{l=0;h.style.transitionDuration="0.4s";a.style.transitionDuration="0.4s";a.style.transitionDelay="0s";h.innerHTML="";A(h,"hide");d=!1},1E3*n)};return{destroy:()=>{f=[];g.remove()},setDisabled:n=>{b.disabled=n},onSave:n=>{f.push(n)}}};return'<div class="f fC"><button class="calib-btn">Calibrate</button><div id="calib-c" class="hide fR"></div><button id="calib-x" class="btn-t hide">&lt; cancel</button></div>'}),va={gen:{ssid:{t:1,l:"SSID",g:0},pass:{t:4,
l:"Password",g:0},deviceName:{t:1,l:"Device name",g:0},mdnsName:{t:1,l:"mDNS Name",g:0},emitSync:{t:2,l:"Emit sync data"}},hw:{axDia:{l:"Axis diameter",g:2,u:"mm"},cDia:{l:"Cord diameter",g:2,u:"mm"},cLen:{l:"Cord length",g:2,u:"mm"},pDir:{l:"Direction pin",g:1},pEn:{l:"Enable pin",g:1},pHome:{l:"Home switch pin",g:1},pMs1:{l:"Microstep pin 1",g:1},pMs2:{l:"Microstep pin 2",g:1},pMs3:{l:"Microstep pin 3",g:1},pReset:{l:"Reset pin",g:1},pSleep:{l:"Sleep pin",g:1},pStep:{l:"Step pin",g:1},stepsPerRev:{l:"Steps/revolution",
g:2},res:{t:3,l:"Resolution",g:2,o:[{l:"1",v:1},{l:"1/2",v:2},{l:"1/4",v:4},{l:"1/8",v:8},{l:"1/16",v:16}]}},mqtt:{enabled:{t:2,l:"Enabled",g:3,cg:!0},host:{t:1,l:"Host",g:3},port:{l:"Port",g:3},topic:{t:1,l:"Topic",g:3},user:{t:1,l:"Username",g:3},pass:{t:4,l:"Password",g:3}}};
t(function(){let a=!0,b=!1,d=!1,f=[],h=[],l=[];const w=[],u=["General","Hardware","MQTT"],q=Object.keys(va);let c,g,e,n,x;this.init=()=>{const r=oa({items:u,queries:q}),z=p=>{const k=O("stcc");if(k){var B;0===p?B=c:1===p?B=g:2===p&&(B=e);k.innerHTML="";S.call(k,B)}else n=()=>z(p)};r.onChange(z);const v=()=>{V("settings loaded: ",Z._state);if(a||b)if(a||!Z.isSaving("settings")){var p=O("sl"),k=O("slc");p.style.display="none";F(k,"hide");k.prepend(r.node);a=!1;b&&D(!1);p=O("stcc");p||(p=M(),p.id="stcc",
S.call(k,p));c=C(q[0]);x=ua();S.call(c,x.node);g=C(q[1]);e=C(q[2]);if(!n)return r.setIndex(r.index());n();n=void 0}};G(()=>{Z.observe("settings",({value:p,prev:k})=>{V("settings updated: ",p,k);v()})});const D=p=>{p!==d&&(b=!1,d=p,x&&x.setDisabled(d),p=O("slc-act"),d?(O("s-save").onclick=()=>{b=!0;f.map(k=>k())},O("s-can").onclick=()=>{b=!0;h.map(k=>k());v()},F(p,"hide")):A(p,"hide"))},C=p=>{const k=L("span"),B=[],H=(E,I)=>{if(null==E)return S.call(k,I.node);if(null==B[E]){const N=M();A(N,"igroup");
B[E]=[N,[]];S.call(k,N)}B[E][1].push(I);S.call(B[E][0],I.node)};for(const E in va[p]){const {g:I,cg:N,l:W,t:Q=0,o:xa,u:ya}=va[p][E],za=`${"pendingState"}.${p}.${E}`,R=ka({label:W,type:Q,enumOpts:xa,value:Z.get(`${"settings"}.${p}.${E}`),unit:ya});H(I,R);const Aa=l.push(R);R.onChange(ia=>{N&&m(ia,R,B[I][0],B[I][1]);w[Aa]=R.isDirty();D(0<w.filter(Ba=>!0===Ba).length);Z.set(za,ia)})}return k};return{destroy:()=>{r.destroy();l.forEach(p=>p.destroy());l=[];f=[];h=[]},onCancel:p=>{h.push(p)},onSave:p=>
{f.push(p)}}};const m=(r,z,v,D)=>{r?F(v,"disabled"):A(v,"disabled");D.forEach(C=>{z!==C&&C.setDisabled(!r)})};return'<div id="ps" class="f fC"><div id="sl" class="loader"></div><div id="slc" class="hide fw" style="text-align: left;"><div id="slc-act" class="fR fw hide"><button id="s-can" class="btn-c">Cancel</button> <button id="s-save" class="btn-s">Save</button></div></div></div>'});
const wa=a=>{const b=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("fill","currentColor");d.setAttribute("d",a.data);b.setAttribute("viewBox",a.box);S.call(b,d);b.style.width=`${a.w}px`;return b};
wa({data:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z",box:"0 0 576 512",
w:22});wa({data:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z",box:"0 0 512 512",w:20});
wa({data:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z",box:"0 0 512 512",
w:20});
